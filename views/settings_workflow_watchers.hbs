{{> header }}

<h1>Watcher Rules</h1>

<p class="lead">Configure who should be notified when leave is requested, approved, or cancelled.</p>

{{> show_flash_messages }}

<div class="row">
    <div class="col-md-3">
        <div class="list-group">
            <a href="/settings/workflow/" class="list-group-item">General Org Entities</a>
            <a href="/settings/workflow/rules/" class="list-group-item">Approval Rules</a>
            <a href="/settings/workflow/watchers/" class="list-group-item active">Watcher Rules</a>
        </div>
    </div>

    <div class="col-md-9">

        <div class="panel panel-default">
            <div class="panel-heading">Active Watchers</div>
            <div class="panel-body">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Project Type</th>
                            <th>Contract Type</th>
                            <th>Watcher (Role)</th>
                            <th>Watcher (Team)</th>
                            <th>Watcher (Project)</th>
                            <th>Team Scope</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each rules}}
                        <tr>
                            <td>{{this.project_type}}</td>
                            <td>{{this.contract_type}}</td>
                            <td>{{this.role.name}}</td>
                            <td>{{this.team.name}}</td>
                            <td>{{this.project.name}}</td>
                            <td>{{#if this.team_scope_required}}<span class="label label-warning">Team</span>{{/if}}
                            </td>
                            <td></td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="panel panel-info">
            <div class="panel-heading">Create New Watcher Rule</div>
            <div class="panel-body">
                <form method="POST" action="/settings/workflow/watchers/add/">
                    <div class="row">
                        <div class="col-md-3">
                            <label>Project Type</label>
                            <select name="project_type" class="form-control" required>
                                <option value="Project">Project</option>
                                <option value="Staff Augmentation">Staff Augmentation</option>
                            </select>
                        </div>
                        <div class=\"col-md-3\">
                            <label>Requester Contract Type</label>
                            <select name=\"contract_type\" class=\"form-control\">
                                <option value=\"\">Any</option>
                                <option value=\"Employee\">Employee</option>
                                <option value=\"Contractor\">Contractor</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label>Watch Role</label>
                            <select name="role_id" class="form-control">
                                <option value="">None</option>
                                {{#each roles}}
                                <option value="{{this.id}}">{{this.name}}</option>
                                {{/each}}
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label>Watch Team</label>
                            <select name="team_id" class="form-control">
                                <option value="">None</option>
                                {{#each teams}}
                                <option value="{{this.id}}">{{this.name}}</option>
                                {{/each}}
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label>Watch Project</label>
                            <select name="project_id" class="form-control">
                                <option value="">None</option>
                                {{#each projects}}
                                <option value="{{this.id}}">{{this.name}}</option>
                                {{/each}}
                            </select>
                        </div>
                    </div>
                    <br>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" name="team_scope_required"> Watcher must be in the same Team/Project
                            membership
                        </label>
                    </div>
                    <hr>
                    <button type="submit" class="btn btn-primary">Save Watcher Rule</button>
                </form>
            </div>
        </div>

    </div>
</div>

{{> footer }}